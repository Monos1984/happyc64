/**************************************************
 *                     Happy C64                  *
 * ---------------------------------------------- * 
 *                     Exemple 2                  *
 * ---------------------------------------------- *
 * Afficher un sprite à l'ecran                   *
 **************************************************/
 
// ===================
// * Fichier include *
// ===================
#include <happyc64.h>


// ============================================
// * Correction de coordonne pour les sprites *
// ============================================
#define C_PX 24
#define C_PY 50


// ======================
// * Tableau de pattern *
// ======================
unsigned char charset_pattern[]=
{
  // -------------
  // * Pattern 0 *
  // -------------
  0,0,0,0,0,0,0,0,    
};

unsigned char sprite_pattern[]=
{
  0b11111111,0b11111111,0b00000000,
  0b10000000,0b00000001,0b00000000,
  0b10000000,0b00000001,0b00000000,
  0b10000000,0b00000001,0b00000000,
  0b10000000,0b00000001,0b00000000,
  0b10000000,0b00000001,0b00000000,
  0b10000000,0b00000001,0b00000000,
  0b10000000,0b00000001,0b00000000,
  0b10000000,0b00000001,0b00000000,
  0b10000000,0b00000001,0b00000000,
  0b10000000,0b00000001,0b00000000,
  0b10000000,0b00000001,0b00000000,
  0b10000000,0b00000001,0b00000000,
  0b10000000,0b00000001,0b00000000,
  0b10000000,0b00000001,0b00000000,
  0b11111111,0b11111111,0b00000000,
  0b00000000,0b00000000,0b00000000,
  0b00000000,0b00000000,0b00000000,
  0b00000000,0b00000000,0b00000000,
  0b00000000,0b00000000,0b00000000,
  0b00000000,0b00000000,0b00000000,
  0b00000000,
};

// ======================
// * La fonction main() *
// ======================
void main()
{  
  // ------------------------------------------
  // * Modifier le fond avec la couleur noire *
  // ------------------------------------------
  set_color_background (C_BLACK);
  
  // -------------------------------------------
  // * Modifier le cadre avec la couleur grise *
  // -------------------------------------------
  set_color_border(C_GREY);
    
  // ----------------------------------
  // * Deplacement du VIC II en $8000 *
  // ----------------------------------
  set_vic_bank(VIC_BANK_2);
  
  // -------------------------------------------------------
  // * Deplacement sur screen memory a l'offet 0 du vic II *
  // -------------------------------------------------------
  set_adresse_screen_memory(SM_0);
  
  // ------------------------------------------------------------------
  // * Deplacement du pointeur de tiles après le screen memory : $800 *
  // ------------------------------------------------------------------
  set_location_character(2);
  
  // ----------------------------------
  // * Copier le pattern     en $8800 *
  // ----------------------------------
  set_data_character(0x8800,charset_pattern,1);
  
  // ----------------------------------------------
  // * Configurer le pattern du sprite 0 en $8C00 *
  // ----------------------------------------------
  /* ............................................................... *
   * adresse du pattern = valeur du pointeur * $40 + adresse du vic  *
   * ............................................................... */
  
  set_pointers_sprite(0,48); // 48 * $40 = $C00 
  
  // ----------------------------------------
  // * Copier le pattern du sprite en $8C00 *
  // ----------------------------------------
  set_sprite_data(0x8C00,sprite_pattern,1);
  
  // -----------------------------------
  // * Modifier la couleur du sprite 0 *
  // -----------------------------------
  set_color_sprite(0,C_YELLOW);
  
  // -------------------------------------------
  // * Configurer le sprite 0 à un emplacement *
  // -------------------------------------------
  draw_sprite(0,0+C_PX,0+C_PY);
  
  // ------------------------
  // * Afficher le sprite 0 *
  // ------------------------
  show_sprite(0);
     
  // ----------------------------------
  // * Effacer l'ecran avec le tile 0 *
  // ----------------------------------
  cls(0);
    
  // ------------------------
  // * Activation du VIC II *
  // ------------------------
  SCREEN_ON;

  // ------------------------------------------
  //  * Boucle infini pour voir le résultat ! *
  // ------------------------------------------
  while(1)
  {
    wait_vbl(); // on attend le début du Vblank.
  } // end while
    
} // end main